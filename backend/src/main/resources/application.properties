# Server Configuration
server.port=${PORT:8080}
server.servlet.context-path=/api

# MongoDB Configuration
spring.data.mongodb.uri=${MONGODB_URI:mongodb://localhost:27017/banana_bill_learning}
spring.data.mongodb.database=${MONGODB_DATABASE:banana_bill_learning}

# MongoDB Connection Pooling (performance tuning)
spring.data.mongodb.auto-index-creation=false
# Connection pool settings (via URI or MongoClientSettings)
# mongodb://host:port/db?maxPoolSize=50&minPoolSize=10&maxIdleTimeMS=60000

# JWT Configuration - MUST be set via environment variable in production!
# Generate secret: openssl rand -base64 64
# SECURITY: No default value - app will fail to start without JWT_SECRET
jwt.secret=${JWT_SECRET:MyDevelopmentSecretKeyForJWTTokenGenerationMustBeAtLeast256BitsLong123456}
jwt.secret.validation.enabled=true
jwt.access-token.expiration=${JWT_ACCESS_EXPIRATION:900000}
jwt.refresh-token.expiration=${JWT_REFRESH_EXPIRATION:604800000}

# CORS Configuration
cors.allowed.origins=${CORS_ORIGINS:http://localhost:5173,http://localhost:3000}

# Twilio WhatsApp Configuration - Set via environment variables
twilio.account.sid=${TWILIO_ACCOUNT_SID:}
twilio.auth.token=${TWILIO_AUTH_TOKEN:}
twilio.whatsapp.from=${TWILIO_WHATSAPP_FROM:}

# Cloudinary for image hosting (required for WhatsApp images)
# Get free account at: https://cloudinary.com/
cloudinary.cloud.name=${CLOUDINARY_CLOUD_NAME:}
cloudinary.upload.preset=${CLOUDINARY_UPLOAD_PRESET:}

# Logging Configuration
logging.level.root=INFO
logging.level.com.bananabill=INFO
logging.level.com.bananabill.service.ImageUploadService=DEBUG
logging.level.com.bananabill.service.WhatsAppService=DEBUG
logging.level.org.springframework.security=WARN
logging.level.org.springframework.web=WARN
logging.level.org.springframework.web=WARN
logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n

# Application Name
spring.application.name=Banana Bill Backend

# Jackson Configuration
spring.jackson.serialization.write-dates-as-timestamps=false
spring.jackson.time-zone=Asia/Kolkata

# Billing Configuration (Domain Rules)
# Danda percentage (7% = 0.07)
billing.danda-percentage=0.07
# Weight per box in KG
billing.box-weight-kg=1.0
# Decimal precision
billing.weight-scale=2
billing.money-scale=2
# Overpayment tracking
billing.track-overpayment=true
# Default page size for queries
billing.default-page-size=100
# Email domain for auto-generated user emails
billing.email-domain=bananabill.app

# Production Security
server.error.include-message=never
server.error.include-stacktrace=never

# Rate Limiting Configuration (requires Redis)
rate.limit.enabled=${RATE_LIMIT_ENABLED:false}
rate.limit.global=100
rate.limit.auth=10
rate.limit.window=60

# Redis Configuration (for caching and rate limiting)
spring.data.redis.host=${REDIS_HOST:localhost}
spring.data.redis.port=${REDIS_PORT:6379}
spring.data.redis.password=${REDIS_PASSWORD:}
spring.data.redis.database=0
spring.data.redis.timeout=2000

# Cache Configuration (use simple cache when Redis not available)
# spring.cache.type=simple
spring.cache.type=${CACHE_TYPE:simple}
spring.cache.redis.time-to-live=3600000
spring.cache.redis.cache-null-values=false

# Exclude Redis Auto Configuration to prevent connection attempts if not using Redis
spring.autoconfigure.exclude=org.springframework.boot.autoconfigure.data.redis.RedisAutoConfiguration

# Monitoring Configuration
management.endpoints.web.exposure.include=health,info,metrics,prometheus
management.endpoint.health.show-details=when-authorized
management.metrics.export.prometheus.enabled=true

# Sentry Configuration (Error Tracking)
sentry.dsn=${SENTRY_DSN:}
sentry.environment=${SPRING_PROFILES_ACTIVE:development}
sentry.traces-sample-rate=0.1

# Exclude Redis Auto Configuration to prevent connection attempts if not using Redis
spring.autoconfigure.exclude=org.springframework.boot.autoconfigure.data.redis.RedisAutoConfiguration
